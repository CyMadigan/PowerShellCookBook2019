# 1.3 Exploring PowerShellGet and gallery


#1 Review what is in PS Get module


PS C:\Foo> Get-Command -Module PowerShellGet

CommandType     Name                                               Version    Source                           
-----------     ----                                               -------    ------                           
Function        Find-Command                                       1.0.0.1    PowerShellGet                    
Function        Find-DscResource                                   1.0.0.1    PowerShellGet                    
Function        Find-Module                                        1.0.0.1    PowerShellGet                    
Function        Find-RoleCapability                                1.0.0.1    PowerShellGet                    
Function        Find-Script                                        1.0.0.1    PowerShellGet                    
Function        Get-InstalledModule                                1.0.0.1    PowerShellGet                    
Function        Get-InstalledScript                                1.0.0.1    PowerShellGet                    
Function        Get-PSRepository                                   1.0.0.1    PowerShellGet                    
Function        Install-Module                                     1.0.0.1    PowerShellGet                    
Function        Install-Script                                     1.0.0.1    PowerShellGet                    
Function        New-ScriptFileInfo                                 1.0.0.1    PowerShellGet                    
Function        Publish-Module                                     1.0.0.1    PowerShellGet                    
Function        Publish-Script                                     1.0.0.1    PowerShellGet                    
Function        Register-PSRepository                              1.0.0.1    PowerShellGet                    
Function        Save-Module                                        1.0.0.1    PowerShellGet                    
Function        Save-Script                                        1.0.0.1    PowerShellGet                    
Function        Set-PSRepository                                   1.0.0.1    PowerShellGet                    
Function        Test-ScriptFileInfo                                1.0.0.1    PowerShellGet                    
Function        Uninstall-Module                                   1.0.0.1    PowerShellGet                    
Function        Uninstall-Script                                   1.0.0.1    PowerShellGet                    
Function        Unregister-PSRepository                            1.0.0.1    PowerShellGet                    
Function        Update-Module                                      1.0.0.1    PowerShellGet                    
Function        Update-ModuleManifest                              1.0.0.1    PowerShellGet                    
Function        Update-Script                                      1.0.0.1    PowerShellGet                    
Function        Update-ScriptFileInfo                              1.0.0.1    PowerShellGet                    



# 2. Update to latest nuget

PS C:\Foo> Install-PackageProvider -Name NuGet -Force -Verbose

VERBOSE: Using the provider 'Bootstrap' for searching packages.
VERBOSE: Finding the package 'Bootstrap::FindPackage' 'NuGet','','','''.
VERBOSE: Performing the operation "Install Package" on target "Package 'nuget' version '2.8.5.208' from 'https:/
/oneget.org/nuget-2.8.5.208.package.swidtag'.".
VERBOSE: Installing the package 'https://oneget.org/nuget-2.8.5.208.package.swidtag'.
VERBOSE: Installed the package 'nuget' to 'C:\Program Files\PackageManagement\ProviderAssemblies\nuget\2.8.5.208
\Microsoft.PackageManagement.NuGetProvider.dll'.

Name                           Version          Source           Summary                                       
----                           -------          ------           -------                                       
nuget                          2.8.5.208        https://onege... NuGet provider for the OneGet meta-package ...
VERBOSE: Importing the package provider NuGet
VERBOSE: The provider 'NuGet' has already been imported. Trying to import it again.
VERBOSE: Loading an assembly 'C:\Program Files\PackageManagement\ProviderAssemblies\nuget\2.8.5.208\Microsoft.Pa
ckageManagement.NuGetProvider.dll'.
VERBOSE: Imported provider 'C:\Program Files\PackageManagement\ProviderAssemblies\nuget\2.8.5.208\Microsoft.Pack
ageManagement.NuGetProvider.dll' .

# 3. Check nuget provider

PS C:\Foo> Get-PackageProvider -Name NuGet |
             Select-Object -Property Version

Version  
-------  
2.8.5.208

# 4. Update PowerShell Get
PS C:\Foo> Install-Module -Name PowerShellGet -Force -Verbose
VERBOSE: Using the provider 'PowerShellGet' for searching packages.
VERBOSE: The -Repository parameter was not specified.  PowerShellGet will use all of the registered repositories
.
VERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.
VERBOSE: The specified Location is 'https://www.powershellgallery.com/api/v2/' and PackageManagementProvider is 
'NuGet'.
VERBOSE: Searching repository 'https://www.powershellgallery.com/api/v2/FindPackagesById()?id='PowerShellGet'' f
or ''.
VERBOSE: Total package yield:'1' for the specified package 'PowerShellGet'.
VERBOSE: Performing the operation "Install-Module" on target "Version '1.6.7' of module 'PowerShellGet'".
VERBOSE: The installation scope is specified to be 'AllUsers'.
VERBOSE: The specified module will be installed in 'C:\Program Files\WindowsPowerShell\Modules'.
VERBOSE: The specified Location is 'NuGet' and PackageManagementProvider is 'NuGet'.
VERBOSE: Downloading module 'PowerShellGet' with version '1.6.7' from the repository 'https://www.powershellgall
ery.com/api/v2/'.
VERBOSE: Searching repository 'https://www.powershellgallery.com/api/v2/FindPackagesById()?id='PowerShellGet'' f
or ''.
VERBOSE: Searching repository 'https://www.powershellgallery.com/api/v2/FindPackagesById()?id='PackageManagement
'' for ''.
VERBOSE: InstallPackage' - name='PackageManagement', version='1.1.7.2',destination='C:\Users\administrator\AppDa
ta\Local\Temp\228357054'
VERBOSE: DownloadPackage' - name='PackageManagement', version='1.1.7.2',destination='C:\Users\administrator\AppD
ata\Local\Temp\228357054\PackageManagement\PackageManagement.nupkg', uri='https://www.powershellgallery.com/api/
v2/package/PackageManagement/1.1.7.2'
VERBOSE: Downloading 'https://www.powershellgallery.com/api/v2/package/PackageManagement/1.1.7.2'.
VERBOSE: Completed downloading 'https://www.powershellgallery.com/api/v2/package/PackageManagement/1.1.7.2'.
VERBOSE: Completed downloading 'PackageManagement'.
VERBOSE: Hash for package 'PackageManagement' does not match hash provided from the server.
VERBOSE: InstallPackageLocal' - name='PackageManagement', version='1.1.7.2',destination='C:\Users\administrator\
AppData\Local\Temp\228357054'
VERBOSE: InstallPackage' - name='PowerShellGet', version='1.6.7',destination='C:\Users\administrator\AppData\Loc
al\Temp\228357054'
VERBOSE: DownloadPackage' - name='PowerShellGet', version='1.6.7',destination='C:\Users\administrator\AppData\Lo
cal\Temp\228357054\PowerShellGet\PowerShellGet.nupkg', uri='https://www.powershellgallery.com/api/v2/package/Pow
erShellGet/1.6.7'
VERBOSE: Downloading 'https://www.powershellgallery.com/api/v2/package/PowerShellGet/1.6.7'.
VERBOSE: Completed downloading 'https://www.powershellgallery.com/api/v2/package/PowerShellGet/1.6.7'.
VERBOSE: Completed downloading 'PowerShellGet'.
VERBOSE: Hash for package 'PowerShellGet' does not match hash provided from the server.
VERBOSE: InstallPackageLocal' - name='PowerShellGet', version='1.6.7',destination='C:\Users\administrator\AppDat
a\Local\Temp\228357054'
VERBOSE: Found the catalog file 'PackageManagement.cat' in the module 'PackageManagement' contents.
VERBOSE: Valid authenticode signature found in the catalog file 'PackageManagement.cat' for the module 'PackageM
anagement'.
VERBOSE: Validating the 'PackageManagement' module files for catalog signing using the catalog file 'PackageMana
gement.cat'.
VERBOSE: The catalog signature in 'PackageManagement.cat' of the module 'PackageManagement' is valid and matches
 with the hash generated from the module contents.
VERBOSE: For publisher validation, current module 'PackageManagement' with version '1.1.7.2' with publisher name
 'CN=Microsoft Root Certificate Authority 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US'. Is this
 module signed by Microsoft: 'True'.
VERBOSE: For publisher validation, using the previously-installed module 'PackageManagement' with version '1.0.0
.1' under 'C:\Program Files\WindowsPowerShell\Modules\PackageManagement\1.0.0.1' with publisher name 'CN=Microso
ft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US'. Is this module sign
ed by Microsoft: 'True'.
VERBOSE: Publisher 'CN=Microsoft Root Certificate Authority 2011, O=Microsoft Corporation, L=Redmond, S=Washingt
on, C=US' of the new module 'PackageManagement' with version '1.1.7.2' matches with the publisher 'CN=Microsoft 
Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US' of the previously-insta
lled module 'PackageManagement' with version '1.0.0.1'. Both versions are signed with a Microsoft root certifica
te.
VERBOSE: Installing the dependency module 'PackageManagement' with version '1.1.7.2' for the module 'PowerShellG
et'.
VERBOSE: Module 'PackageManagement' was installed successfully to path 'C:\Program Files\WindowsPowerShell\Modul
es\PackageManagement\1.1.7.2'.
VERBOSE: Found the catalog file 'PowerShellGet.cat' in the module 'PowerShellGet' contents.
VERBOSE: Valid authenticode signature found in the catalog file 'PowerShellGet.cat' for the module 'PowerShellGe
t'.
VERBOSE: Validating the 'PowerShellGet' module files for catalog signing using the catalog file 'PowerShellGet.c
at'.
VERBOSE: The catalog signature in 'PowerShellGet.cat' of the module 'PowerShellGet' is valid and matches with th
e hash generated from the module contents.
VERBOSE: For publisher validation, current module 'PowerShellGet' with version '1.6.7' with publisher name 'CN=M
icrosoft Root Certificate Authority 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US'. Is this modul
e signed by Microsoft: 'True'.
VERBOSE: For publisher validation, using the previously-installed module 'PowerShellGet' with version '1.0.0.1' 
under 'C:\Program Files\WindowsPowerShell\Modules\PowerShellGet\1.0.0.1' with publisher name 'CN=Microsoft Root 
Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US'. Is this module signed by Mi
crosoft: 'True'.
VERBOSE: Publisher 'CN=Microsoft Root Certificate Authority 2011, O=Microsoft Corporation, L=Redmond, S=Washingt
on, C=US' of the new module 'PowerShellGet' with version '1.6.7' matches with the publisher 'CN=Microsoft Root C
ertificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US' of the previously-installed m
odule 'PowerShellGet' with version '1.0.0.1'. Both versions are signed with a Microsoft root certificate.
VERBOSE: Module 'PowerShellGet' was installed successfully to path 'C:\Program Files\WindowsPowerShell\Modules\P
owerShellGet\1.6.7'.


# 5. Check version of PS Get

C:\Foo> Get-Module -Name PowerShellGet |
            Select-Object -ExpandProperty Version

Major  Minor  Build  Revision
-----  -----  -----  --------
1      0      0      1     


# 6 View default repos

PS C:\Foo> Get-PSRepository

Name                      InstallationPolicy   SourceLocation                                                  
----                      ------------------   --------------                                                  
PSGallery                 Untrusted            https://www.powershellgallery.com/api/v2/ 


# 7. Find package providers

PS C:\Foo> Find-PackageProvider |
    Select-Object -Property Name, Source, Summary |
        Format-Table -Wrap -AutoSize

Name                      Source                                                           Summary             
----                      ------                                                           -------             
nuget                     https://oneget.org/nuget-2.8.5.208.package.swidtag               NuGet provider for  
                                                                                           the OneGet          
                                                                                           meta-package manager
psl                       https://oneget.org/psl-1.0.0.210.package.swidtag                 psl provider for    
                                                                                           the OneGet          
                                                                                           meta-package manager
chocolatey                https://oneget.org/ChocolateyPrototype-2.8.5.130.package.swidtag ChocolateyPrototype 
                                                                                           provider for the    
                                                                                           OneGet meta-package 
                                                                                           manager             
PowerShellGet             PSGallery                                                        PowerShell module   
                                                                                           with commands for   
                                                                                           discovering,        
                                                                                           installing,         
                                                                                           updating and        
                                                                                           publishing the      
                                                                                           PowerShell          
                                                                                           artifacts like      
                                                                                           Modules, DSC        
                                                                                           Resources, Role     
                                                                                           Capabilities and    
                                                                                           Scripts.            
DockerMsftProvider        PSGallery                                                        PowerShell module   
                                                                                           with commands for   
                                                                                           discovering,        
                                                                                           installing, and     
                                                                                           updating Docker     
                                                                                           images.             
NanoServerPackage         PSGallery                                                        A PackageManagement 
                                                                                           provider to         
                                                                                           Discover, Save and  
                                                                                           Install Nano Server 
                                                                                           Packages on-demand  
ChocolateyGet             PSGallery                                                        An PowerShell       
                                                                                           OneGet provider     
                                                                                           that discovers      
                                                                                           packages from https:
                                                                                           //www.chocolatey.org
                                                                                           .                   
DockerProvider            PSGallery                                                        PowerShell module   
                                                                                           with commands for   
                                                                                           discovering,        
                                                                                           installing, and     
                                                                                           updating Docker     
                                                                                           images.             
ContainerImage            PSGallery                                                        This is a           
                                                                                           PackageManagement   
                                                                                           provider module     
                                                                                           which helps in      
                                                                                           discovering,        
                                                                                           downloading and     
                                                                                           installing Windows  
                                                                                           Container OS images.
                                                                                                               
                                                                                           For more details    
                                                                                           and examples refer  
                                                                                           to our project site 
                                                                                           at https://github.co
                                                                                           m/PowerShell/Contain
                                                                                           erProvider.         
DockerMsftProviderInsider PSGallery                                                        PowerShell module   
                                                                                           with commands for   
                                                                                           discovering,        
                                                                                           installing, and     
                                                                                           updating Docker     
                                                                                           images.             
GitHubProvider            PSGallery                                                        GitHub-as-a-Package 
                                                                                           - PackageManagement 
                                                                                           PowerShell Provider 
                                                                                           to interop with     
                                                                                           Github              
GistProvider              PSGallery                                                        Gist-as-a-Package - 
                                                                                           PackageManagement   
                                                                                           PowerShell Provider 
                                                                                           to interop with     
                                                                                           Github Gists        
TSDProvider               PSGallery                                                        PowerShell          
                                                                                           PackageManager      
                                                                                           provider to search  
                                                                                           & install           
                                                                                           TypeScript          
                                                                                           definition files    
                                                                                           from the community  
                                                                                           DefinitelyTyped repo
GitLabProvider            PSGallery                                                        GitLab              
                                                                                           PackageManagement   
                                                                                           provider            
OfficeProvider            PSGallery                                                        OfficeProvider      
                                                                                           allows users to     
                                                                                           install Microsoft   
                                                                                           Office365 ProPlus   
                                                                                           from Powershell.    
MyAlbum                   PSGallery                                                        MyAlbum provider    
                                                                                           discovers the       
                                                                                           photos in your      
                                                                                           remote file         
                                                                                           repository and      
                                                                                           installs them to    
                                                                                           your local folder.  
0install                  PSGallery                                                        Zero Install is a   
                                                                                           decentralized       
                                                                                           cross-platform softw
                                                                                           are-installation    
                                                                                           system.             
WSAProvider               PSGallery                                                        Provider to         
                                                                                           Discover, Install   
                                                                                           and inventory       
                                                                                           windows server apps 
AppxGet                   PSGallery                                                        Powershell Package  
                                                                                           Management (OneGet) 
                                                                                           Provider for AppX   
                                                                                           packages.  

        
# 8. View available providers with packages in PSGallery:

PS C:\Foo> Find-PackageProvider -Source PSGallery |
    Select-Object -Property Name, Summary |
        Format-Table -Wrap -AutoSize

Name                      Summary                                                                              
----                      -------                                                                              
PowerShellGet             PowerShell module with commands for discovering, installing, updating and publishing 
                          the PowerShell artifacts like Modules, DSC Resources, Role Capabilities and Scripts. 
NanoServerPackage         A PackageManagement provider to  Discover, Save and Install Nano Server Packages     
                          on-demand                                                                            
DockerProvider            PowerShell module with commands for discovering, installing, and updating Docker     
                          images.                                                                              
ContainerImage            This is a PackageManagement provider module which helps in discovering, downloading  
                          and installing Windows Container OS images.                                          
                                                                                                               
                          For more details and examples refer to our project site at                           
                          https://github.com/PowerShell/ContainerProvider.                                     
ChocolateyGet             An PowerShell OneGet provider that discovers packages from                           
                          https://www.chocolatey.org.                                                          
DockerMsftProvider        PowerShell module with commands for discovering, installing, and updating Docker     
                          images.                                                                              
DockerMsftProviderInsider PowerShell module with commands for discovering, installing, and updating Docker     
                          images.                                                                              
GistProvider              Gist-as-a-Package - PackageManagement  PowerShell Provider to interop with Github    
                          Gists                                                                                
GitHubProvider            GitHub-as-a-Package - PackageManagement PowerShell Provider to interop with Github   
OfficeProvider            OfficeProvider allows users to install Microsoft Office365 ProPlus from Powershell.  
TSDProvider               PowerShell PackageManager provider to search & install TypeScript definition files   
                          from the community DefinitelyTyped repo                                              
GitLabProvider            GitLab PackageManagement provider                                                    
MyAlbum                   MyAlbum provider discovers the photos in your remote file repository and installs    
                          them to your local folder.                                                           
0install                  Zero Install is a decentralized cross-platform software-installation system.         
WSAProvider               Provider to Discover, Install and inventory windows server apps                      
AppxGet                   Powershell Package Management (OneGet) Provider for AppX packages.                   



# 9 Finding finding things:

PS C:\Foo> Get-Command -Module PowerShellGet -Verb Find

CommandType     Name                                               Version    Source                           
-----------     ----                                               -------    ------                           
Function        Find-Command                                       1.0.0.1    PowerShellGet                    
Function        Find-DscResource                                   1.0.0.1    PowerShellGet                    
Function        Find-Module                                        1.0.0.1    PowerShellGet                    
Function        Find-RoleCapability                                1.0.0.1    PowerShellGet                    
Function        Find-Script                                        1.0.0.1    PowerShellGet 


# 10. Request all the commands in the PowerShellGet module, store them in a
#     variable, and display the count as well:

PS C:\Foo> $Commands = Find-Command -Module PowerShellGet
$CommandCount = $Commands.Count
"$CommandCount commands available in PowerShellGet"

25 commands available in PowerShellGet



